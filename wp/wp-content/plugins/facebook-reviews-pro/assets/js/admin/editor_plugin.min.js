!function(){tinymce.PluginManager.add("fbw_shortcode_button",function(t,e){function o(e,o){t.windowManager.open({title:d.getLang("fbw.shortcode_generator_title"),id:"fbw_shortcode_dialog",width:600,height:450,resizable:!0,scrollbars:!0,url:ajaxurl+"?action=fbw_shortcode_iframe"},{shortcode:d.getLang("fbw.shortcode_tag"),shortcode_params:window.decodeURIComponent(o)})}function n(t,e){return e=new RegExp(e+'="([^"]+)"',"g").exec(t),e?window.decodeURIComponent(e[1]):""}function a(t){return t.replace(/\[facebook_widget_pro([^\]]*)\]/g,function(t,e,o){return c("wp-facebook-widget-pro",e,o)})}function r(t){return t.replace(/(?:<p(?: [^>]+)?>)*(<img [^>]+>)(<\/p>)*/g,function(t,e){var o=n(e,"data-fbw-attr");return o?"<p>["+i+o+"]</p>":t})}function c(t,o,n){var a=e+"/shortcode-placeholder.jpg";return o=window.encodeURIComponent(o),'<img src="'+a+'" class="mceItem '+t+'" data-fbw-attr="'+o+'" data-mce-resize="false" data-mce-placeholder="1" />'}var d=tinymce.activeEditor,i="facebook_widget_pro";t.addCommand("fbw_shortcode_popup",o),t.addButton("fbw_shortcode_button",{title:d.getLang("fbw.shortcode_generator_title"),icon:"fbw dashicons-facebook",onclick:o}),t.on("BeforeSetcontent",function(t){t.content=a(t.content)}),t.on("GetContent",function(t){t.content=r(t.content)}),t.on("DblClick",function(e){var o=e.target.className.indexOf("wp-facebook-widget-pro"),n=e.target.attributes["data-fbw-attr"].value;"IMG"==e.target.nodeName&&o>-1&&t.execCommand("fbw_shortcode_popup",!1,n)})})}();